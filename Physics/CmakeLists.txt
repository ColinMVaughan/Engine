cmake_minimum_required(VERSION 3.0)
project(Physics)

file(GLOB SOURCES "Src/*.cpp")
file(GLOB HEADERS "Include/*.h")

add_library(Physics STATIC ${SOURCES} ${HEADERS})

set(PhysLibraryPath "${CMAKE_CURRENT_SOURCE_DIR}/Dependencies/PhysX/Lib/Checked_x86")
set(PhysLibType "CHECKED_x86.lib")

target_link_libraries(Physics 
${PhysLibraryPath}/PhysX3${PhysLibType}
${PhysLibraryPath}/PhysX3Common${PhysLibType}
${PhysLibraryPath}/PxFoundation${PhysLibType}
${PhysLibraryPath}/PxPvdSDK${PhysLibType}
${PhysLibraryPath}/PhysX3ExtensionsCHECKED.lib
${PhysLibraryPath}/PhysX3Gpu${PhysLibType}
${PhysLibraryPath}/PhysX3CharacterKinematic${PhysLibType})


target_include_directories(Physics PUBLIC 
			$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/Include>
			$<INSTALL_INTERFACE:Include>)
			
target_include_directories(Physics PUBLIC 
			$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/Dependencies/PhysX/Include/>
			$<INSTALL_INTERFACE:Dependencies/PhysX/Include>)

install(TARGETS Physics 
		ARCHIVE DESTINATION Lib
		LIBRARY DESTINATION Lib
		INCLUDES DESTINATION Include)
		
install(FILES ${HEADERS} DESTINATION Include/Physics)

set(PhysDLLPath "${CMAKE_CURRENT_SOURCE_DIR}/Dependencies/PhysX/Bin/Checked_x86")
set(PhysDLLType "CHECKED_x86.dll")

install(FILES 
${PhysDLLPath}/PhysX3${PhysDLLType}
${PhysDLLPath}/PhysX3Common${PhysDLLType}
${PhysDLLPath}/PxFoundation${PhysDLLType}
${PhysDLLPath}/PxPvdSDK${PhysDLLType}
${PhysDLLPath}/nvToolsExt32_1.dll
${PhysDLLPath}/PhysX3CharacterKinematic${PhysDLLType}
DESTINATION bin)